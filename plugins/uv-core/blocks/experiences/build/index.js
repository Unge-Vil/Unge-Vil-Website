(()=>{"use strict";var e,r={810:()=>{const e=window.React,r=window.wp.i18n,t=window.wp.blocks,a=window.wp.blockEditor,n=window.wp.components,l=window.wp.element,o=window.wp.coreData,c=JSON.parse('{"UU":"uv/experiences"}'),s=e=>{var r;const t=(null!==(r=e.meta?.uv_experience_dates)&&void 0!==r?r:"").match(/\b(\d{4})\b/);if(t?.[1])return t[1];if(e.date){const r=new Date(e.date);if(!Number.isNaN(r.getFullYear()))return String(r.getFullYear())}return""},i=({post:r,year:t})=>{var a;const n=r.meta?.uv_experience_org,l=r.meta?.uv_experience_dates,o=r._embedded?.["wp:featuredmedia"]?.[0]?.source_url;return(0,e.createElement)("li",{className:"uv-card uv-card--experience"},(0,e.createElement)("a",{href:null!==(a=r.link)&&void 0!==a?a:"#",onClick:e=>e.preventDefault()},o?(0,e.createElement)("img",{src:o,alt:r.title.rendered}):(0,e.createElement)("div",{className:"uv-card-icon","aria-hidden":"true"},(0,e.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},(0,e.createElement)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,e.createElement)("circle",{cx:"12",cy:"7",r:"4"}))),(0,e.createElement)("div",{className:"uv-card-body"},(0,e.createElement)("div",{className:"uv-card-meta__year"},t),(0,e.createElement)("h3",null,r.title.rendered),(n||l)&&(0,e.createElement)("div",{className:"uv-card-meta"},n&&(0,e.createElement)("div",{className:"uv-card-meta__org"},n),l&&(0,e.createElement)("div",{className:"uv-card-meta__dates"},l)),r.excerpt?.rendered&&(0,e.createElement)("div",{className:"uv-card-excerpt"},(0,e.createElement)("span",{dangerouslySetInnerHTML:{__html:r.excerpt.rendered}})))))},u=({posts:t,layout:a,isLoading:l})=>{const o=["uv-experiences",`uv-experiences--${a}`],c=["uv-experiences__year-list"];"list"!==a&&c.push("uv-card-list"),"grid"===a&&c.push("uv-card-grid","columns-3");const u=Object.entries((null!=t?t:[]).reduce((e,r)=>{const t=s(r);return e[t]||(e[t]=[]),e[t].push(r),e},{})).sort(([e],[r])=>r.localeCompare(e)).map(([e,r])=>({year:e,items:r}));return l?(0,e.createElement)("p",{className:"uv-block-placeholder"},(0,e.createElement)(n.Spinner,null)," ",(0,r.__)("Laster forhåndsvisning…","uv-core")):t?.length?(0,e.createElement)("ul",{className:o.join(" ")},u.map(({year:r,items:t})=>(0,e.createElement)("li",{key:r,className:"uv-experiences__year-group"},(0,e.createElement)("div",{className:"uv-experiences__year-heading"},r),(0,e.createElement)("ul",{className:c.join(" ")},t.map(r=>(0,e.createElement)(i,{key:r.id,post:r,year:s(r)})))))):(0,e.createElement)("div",{className:"uv-block-placeholder"},(0,r.__)("Ingen erfaringer funnet.","uv-core"))};(0,t.registerBlockType)(c.UU,{edit({attributes:{count:t,layout:c,pagination:i,year:d},setAttributes:v}){const[m,p]=(0,l.useState)(1),[_,g]=(0,l.useState)([]),{records:E}=(0,o.useEntityRecords)("postType","uv_experience",{per_page:100,_fields:["id","meta","date"]}),{records:f,isResolving:h,hasResolved:b,totalPages:y}=(0,o.useEntityRecords)("postType","uv_experience",{per_page:t,page:m,_embed:!0,_fields:["id","title","excerpt","link","meta","featured_media","date"],...d?{after:`${d}-01-01T00:00:00`,before:`${d}-12-31T23:59:59`}:{}});(0,l.useEffect)(()=>{p(1),g([])},[t,i,d]),(0,l.useEffect)(()=>{b&&Array.isArray(f)&&g(e=>{if(1===m)return f;const r=new Set(e.map(e=>e.id)),t=[...e];return f.forEach(e=>{r.has(e.id)||t.push(e)}),t})},[f,b,m]);const w=i&&!!y&&m<y,k=(0,l.useMemo)(()=>{const e=new Set([""]);return(null!=E?E:[]).forEach(r=>{const t=s(r);t&&e.add(t)}),Array.from(e).filter(Boolean).sort((e,r)=>r.localeCompare(e)).map(e=>({label:e,value:e})).concat([{label:(0,r.__)("Alle år","uv-core"),value:""}]).reverse()},[E]);return(0,e.createElement)(l.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:(0,r.__)("Innstillinger","uv-core"),initialOpen:!0},(0,e.createElement)(n.RangeControl,{label:(0,r.__)("Antall","uv-core"),min:1,max:100,value:t,onChange:e=>v({count:e})}),(0,e.createElement)(n.SelectControl,{label:(0,r.__)("Layout","uv-core"),value:c,onChange:e=>v({layout:e}),options:[{label:(0,r.__)("Liste","uv-core"),value:"list"},{label:(0,r.__)("Rutenett","uv-core"),value:"grid"},{label:(0,r.__)("Tidslinje","uv-core"),value:"timeline"}]}),(0,e.createElement)(n.SelectControl,{label:(0,r.__)("År","uv-core"),value:d,options:k,onChange:e=>v({year:e}),help:(0,r.__)("Filtrer erfaringer etter år.","uv-core")}),(0,e.createElement)(n.ToggleControl,{label:(0,r.__)("Aktiver paginering","uv-core"),checked:i,onChange:e=>v({pagination:e}),help:(0,r.__)("Vis en knapp for å hente flere erfaringer.","uv-core")}))),(0,e.createElement)("div",{...(0,a.useBlockProps)()},b&&Array.isArray(f)?(0,e.createElement)(u,{posts:_,layout:c,isLoading:!1}):(0,e.createElement)(u,{posts:[],layout:c,isLoading:h}),i&&(0,e.createElement)("div",{className:"uv-block-pagination"},(0,e.createElement)("button",{className:"uv-button",type:"button",disabled:h||!w,onClick:()=>p(e=>e+1)},w?(0,r.__)("Last inn flere","uv-core"):(0,r.__)("Alle erfaringer er lastet inn","uv-core")))))},save:()=>null})}},t={};function a(e){var n=t[e];if(void 0!==n)return n.exports;var l=t[e]={exports:{}};return r[e](l,l.exports,a),l.exports}a.m=r,e=[],a.O=(r,t,n,l)=>{if(!t){var o=1/0;for(u=0;u<e.length;u++){for(var[t,n,l]=e[u],c=!0,s=0;s<t.length;s++)(!1&l||o>=l)&&Object.keys(a.O).every(e=>a.O[e](t[s]))?t.splice(s--,1):(c=!1,l<o&&(o=l));if(c){e.splice(u--,1);var i=n();void 0!==i&&(r=i)}}return r}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[t,n,l]},a.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e={57:0,350:0};a.O.j=r=>0===e[r];var r=(r,t)=>{var n,l,[o,c,s]=t,i=0;if(o.some(r=>0!==e[r])){for(n in c)a.o(c,n)&&(a.m[n]=c[n]);if(s)var u=s(a)}for(r&&r(t);i<o.length;i++)l=o[i],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(u)},t=globalThis.webpackChunkuv_wordpress=globalThis.webpackChunkuv_wordpress||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})();var n=a.O(void 0,[350],()=>a(810));n=a.O(n)})();